# Outlook é‚®ç®±è‡ªåŠ¨æ³¨å†Œè„šæœ¬ - ä½¿ç”¨æŒ‡å—

## å¿«é€Ÿå¼€å§‹ (5åˆ†é’Ÿ)

### ç¬¬ä¸€æ­¥ï¼šå®‰è£…ä¾èµ–

```bash
# å®‰è£… Python åŒ…
pip install nodriver

# å®‰è£…æµè§ˆå™¨ (é€‰æ‹©ä¸€ä¸ª)
# æ–¹å¼ 1: ä½¿ç”¨è‡ªåŠ¨è„šæœ¬ (æ¨è)
bash example/quick_start_outlook.sh

# æ–¹å¼ 2: æ‰‹åŠ¨å®‰è£… Google Chrome
sudo apt-get update && sudo apt-get install -y google-chrome-stable
```

### ç¬¬äºŒæ­¥ï¼šè¿è¡Œè„šæœ¬

```bash
# ç®€åŒ–ç‰ˆæœ¬ (æ¨èåˆå­¦è€…)
cd /workspaces/nodriver
python example/register_outlook_simple.py

# æˆ–å®Œæ•´ç‰ˆæœ¬ (æ›´è¯¦ç»†çš„æ—¥å¿—)
python example/register_outlook_account.py
```

### ç¬¬ä¸‰æ­¥ï¼šæŸ¥çœ‹ç»“æœ

```bash
# æŸ¥çœ‹ç”Ÿæˆçš„è´¦æˆ·ä¿¡æ¯
cat /tmp/outlook_registration/accounts/outlook_*.json

# æˆ–ä½¿ç”¨å®Œæ•´ç‰ˆæœ¬çš„è¾“å‡ºç›®å½•
cat debug_output/accounts/outlook_account_*.json
```

## è¯¦ç»†è¯´æ˜

### ç®€åŒ–ç‰ˆæœ¬ vs å®Œæ•´ç‰ˆæœ¬

| åŠŸèƒ½ | ç®€åŒ–ç‰ˆ | å®Œæ•´ç‰ˆ |
|------|--------|--------|
| åŸºç¡€æ³¨å†Œ | âœ“ | âœ“ |
| è‡ªåŠ¨ç”Ÿæˆè´¦æˆ· | âœ“ | âœ“ |
| æ—¥å¿—è®°å½• | ç®€å• | è¯¦ç»† |
| é”™è¯¯å¤„ç† | åŸºç¡€ | å®Œæ•´ |
| è°ƒè¯•ä¿¡æ¯ | å¦ | æ˜¯ |
| æˆªå›¾ä¿å­˜ | æ˜¯ | æ˜¯ |
| ä»£ç è¡Œæ•° | ~200 | ~600 |
| å­¦ä¹ éš¾åº¦ | ä½ | ä¸­ |

**æ¨è:**
- **åˆå­¦è€…**: ä½¿ç”¨ç®€åŒ–ç‰ˆæœ¬ (`register_outlook_simple.py`)
- **è°ƒè¯•/é—®é¢˜æ’æŸ¥**: ä½¿ç”¨å®Œæ•´ç‰ˆæœ¬ (`register_outlook_account.py`)

### è„šæœ¬å¦‚ä½•å·¥ä½œ

```
1. å¯åŠ¨æµè§ˆå™¨
   â””â”€ ä½¿ç”¨ Google Chrome/Chromium
      â””â”€ æ— å¤´æ¨¡å¼ (headless=True)

2. ç”Ÿæˆéšæœºè´¦æˆ·ä¿¡æ¯
   â”œâ”€ é‚®ç®±: randomstring@outlook.com
   â”œâ”€ å¯†ç : RandomStr!ng123%
   â”œâ”€ åå­—: Random Name
   â””â”€ ç”Ÿæ—¥: MM/DD/YYYY

3. è®¿é—® Outlook æ³¨å†Œé¡µé¢
   â””â”€ URL: https://go.microsoft.com/fwlink/p/?linkid=2125440

4. å¡«å†™æ³¨å†Œè¡¨å•
   â”œâ”€ é‚®ç®±åœ°å€
   â”œâ”€ å¯†ç 
   â”œâ”€ åå­—
   â””â”€ ç”Ÿæ—¥ (å¯é€‰)

5. æäº¤è¡¨å•
   â””â”€ ç­‰å¾… Microsoft éªŒè¯

6. ä¿å­˜ä¿¡æ¯
   â”œâ”€ è´¦æˆ·ä¿¡æ¯ (JSON)
   â”œâ”€ æˆªå›¾
   â””â”€ æ—¥å¿—
```

## æ–‡ä»¶ä½ç½®

### ç®€åŒ–ç‰ˆæœ¬è¾“å‡º
```
/tmp/outlook_registration/
â”œâ”€â”€ accounts/
â”‚   â””â”€â”€ outlook_20260110_131733.json
â””â”€â”€ screenshots/
    â””â”€â”€ final_20260110_131733.png
```

### å®Œæ•´ç‰ˆæœ¬è¾“å‡º
```
/workspaces/nodriver/debug_output/
â”œâ”€â”€ outlook_register_20260110_131510.log  (æ—¥å¿—)
â”œâ”€â”€ accounts/
â”‚   â””â”€â”€ outlook_account_20260110_131733.json
â””â”€â”€ screenshots/
    â”œâ”€â”€ outlook_signup_page_direct_20260110_131518.png
    â”œâ”€â”€ outlook_email_entered_20260110_131523.png
    â”œâ”€â”€ outlook_password_entered_20260110_131529.png
    â”œâ”€â”€ outlook_name_entered_20260110_131628.png
    â””â”€â”€ outlook_verification_page_X_*.png
```

## è´¦æˆ·ä¿¡æ¯æ ¼å¼

ç”Ÿæˆçš„ JSON æ–‡ä»¶åŒ…å«ï¼š

```json
{
  "email": "s388u4srm9su@outlook.com",      // é‚®ç®±åœ°å€
  "password": "qywo8c2gzrq77nz3",           // å¯†ç 
  "name": "Lisa Garcia",                    // ç”¨æˆ·å
  "birth_date": "12/21/1999",               // ç”Ÿæ—¥
  "created_at": "2026-01-10T13:17:33",      // åˆ›å»ºæ—¶é—´
  "status": "registered"                    // çŠ¶æ€
}
```

## å¸¸è§é—®é¢˜è§£ç­”

### Q1: è„šæœ¬å¤šä¹…å®Œæˆæ³¨å†Œï¼Ÿ

**ç­”:** é€šå¸¸éœ€è¦ 2-5 åˆ†é’Ÿï¼Œå–å†³äºï¼š
- ç½‘ç»œé€Ÿåº¦
- Microsoft æœåŠ¡å™¨å“åº”æ—¶é—´
- æ˜¯å¦éœ€è¦é¢å¤–éªŒè¯

### Q2: è´¦æˆ·æ˜¯å¦çœŸçš„è¢«æ³¨å†Œäº†ï¼Ÿ

**ç­”:** æ˜¯çš„ã€‚è„šæœ¬å®Œæˆåï¼Œè´¦æˆ·åº”è¯¥å·²æ³¨å†Œã€‚ä½†ï¼š
- å¯èƒ½éœ€è¦é‚®ç®±éªŒè¯
- æ£€æŸ¥ Outlook é‚®ç®±çš„æ”¶ä»¶ç®±æˆ–åƒåœ¾é‚®ä»¶
- ä½¿ç”¨ç”Ÿæˆçš„å‡­è¯ç›´æ¥ç™»å½•æµ‹è¯•

### Q3: å¯†ç æ ¼å¼æœ‰ä»€ä¹ˆè¦æ±‚å—ï¼Ÿ

**ç­”:** è„šæœ¬ç”Ÿæˆçš„å¯†ç æ»¡è¶³ Microsoft çš„è¦æ±‚ï¼š
- è‡³å°‘ 8 ä¸ªå­—ç¬¦
- åŒ…å«å­—æ¯ã€æ•°å­—å’Œç¬¦å·
- ä¸åŒ…å«å¸¸è§çš„å¼±å¯†ç 

### Q4: ä¸€æ¬¡å¯ä»¥æ³¨å†Œå¤šå°‘ä¸ªè´¦æˆ·ï¼Ÿ

**ç­”:** ç†è®ºä¸Šæ— é™åˆ¶ï¼Œä½†ï¼š
- Microsoft å¯èƒ½ä¼šå¯¹é¢‘ç¹çš„æ³¨å†Œè¯·æ±‚æ–½åŠ é€Ÿç‡é™åˆ¶
- å»ºè®®æ¯ä¸ªæ³¨å†Œé—´éš” 30+ ç§’
- é¿å…åœ¨çŸ­æ—¶é—´å†…å¤§é‡æ³¨å†Œ

### Q5: èƒ½å¦è‡ªå®šä¹‰è´¦æˆ·ä¿¡æ¯ï¼Ÿ

**ç­”:** å¯ä»¥ã€‚ä¿®æ”¹è„šæœ¬ä¸­çš„ç”Ÿæˆå‡½æ•°ï¼š

```python
# ä¸ä½¿ç”¨éšæœºé‚®ç®±ï¼Œä½¿ç”¨ç‰¹å®šé‚®ç®±
email = "myemail123@outlook.com"

# ä¸ä½¿ç”¨éšæœºå¯†ç ï¼Œä½¿ç”¨ç‰¹å®šå¯†ç   
password = "MyPassword123!"

# ä¸ä½¿ç”¨éšæœºåå­—ï¼Œä½¿ç”¨ç‰¹å®šåå­—
name = "John Doe"
```

### Q6: å¦‚ä½•æ‰¹é‡æ³¨å†Œå¤šä¸ªè´¦æˆ·ï¼Ÿ

**ç­”:** åˆ›å»º `batch_register.py`:

```python
import subprocess
import time

for i in range(5):
    print(f"æ³¨å†Œè´¦æˆ· {i+1}/5...")
    subprocess.run(['python', 'register_outlook_simple.py'])
    time.sleep(60)  # æ¯ä¸ªæ³¨å†Œé—´éš” 60 ç§’
```

ç„¶åè¿è¡Œï¼š
```bash
python batch_register.py
```

## æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: "Failed to connect to browser"

**ç—‡çŠ¶:** è„šæœ¬å¯åŠ¨å¤±è´¥ï¼Œæ˜¾ç¤ºæµè§ˆå™¨è¿æ¥é”™è¯¯

**è§£å†³:**
```bash
# ç¡®ä¿å®‰è£…äº†æµè§ˆå™¨
google-chrome-stable --version

# å¦‚æœæ²¡æœ‰ï¼Œå®‰è£…å®ƒ
sudo apt-get install -y google-chrome-stable

# æ£€æŸ¥ nodriver ç‰ˆæœ¬
pip list | grep nodriver

# å°è¯•é‡æ–°å®‰è£…
pip install --upgrade nodriver
```

### é—®é¢˜ 2: "Cannot find email input"

**ç—‡çŠ¶:** è„šæœ¬æ— æ³•æ‰¾åˆ°é‚®ç®±è¾“å…¥æ¡†

**åŸå› :** Outlook é¡µé¢ç»“æ„å¯èƒ½å·²æ›´æ”¹

**è§£å†³:**
1. ä½¿ç”¨å®Œæ•´ç‰ˆæœ¬è·å– HTML è°ƒè¯•ä¿¡æ¯
2. æŸ¥çœ‹ç”Ÿæˆçš„æˆªå›¾
3. ä¿®æ”¹è„šæœ¬ä¸­çš„é€‰æ‹©å™¨
4. æäº¤é—®é¢˜åˆ°é¡¹ç›® Issues

### é—®é¢˜ 3: "Timeout waiting for element"

**ç—‡çŠ¶:** è„šæœ¬ç­‰å¾…å¤ªé•¿æ—¶é—´æ‰¾ä¸åˆ°å…ƒç´ 

**åŸå› :** ç½‘ç»œè¿æ¥æ…¢æˆ–é¡µé¢æœªå®Œå…¨åŠ è½½

**è§£å†³:**
```python
# å¢åŠ ç­‰å¾…æ—¶é—´
await tab.sleep(10)  # ä» 8 ç§’å¢åŠ åˆ° 10 ç§’

# æˆ–ä¿®æ”¹é€‰æ‹©å™¨è¶…æ—¶
await tab.select("selector", timeout=15)
```

### é—®é¢˜ 4: é‚®ç®±è¢«æ‹’ç»

**ç—‡çŠ¶:** é‚®ç®±è¾“å…¥åå‡ºç°é”™è¯¯ï¼Œæç¤ºé‚®ç®±å·²å­˜åœ¨

**åŸå› :** éšæœºç”Ÿæˆçš„é‚®ç®±ç¢°å·§å·²è¢«æ³¨å†Œ

**è§£å†³:**
- è„šæœ¬ä¼šè‡ªåŠ¨ç”Ÿæˆæ–°é‚®ç®±ï¼Œé‡æ–°è¿è¡Œå³å¯
- æˆ–æ‰‹åŠ¨ä¿®æ”¹é‚®ç®±ç”Ÿæˆé€»è¾‘

## é«˜çº§ç”¨æ³•

### è‡ªå®šä¹‰æµè§ˆå™¨å‚æ•°

```python
driver = await uc.start(
    headless=False,  # æ˜¾ç¤ºæµè§ˆå™¨çª—å£ç”¨äºè°ƒè¯•
    no_sandbox=True,
    browser_executable_path="/usr/bin/google-chrome-stable",
    browser_args=[
        '--disable-dev-shm-usage',
        '--disable-gpu',
        '--no-first-run',
        '--disable-extensions',
    ]
)
```

### ä¿å­˜é¢å¤–çš„è°ƒè¯•ä¿¡æ¯

```python
# ä¿å­˜é¡µé¢ HTML
html = await tab.get_content()
with open("page.html", "w") as f:
    f.write(html)

# ä¿å­˜é¡µé¢æ ‡é¢˜
print(f"é¡µé¢æ ‡é¢˜: {tab.title}")

# ä¿å­˜å½“å‰ URL
print(f"å½“å‰ URL: {tab.url}")

# è·å–å…ƒç´ å±æ€§
element = await tab.select("input[type='email']")
name = await element.get_attribute("name")
```

### ä½¿ç”¨ä»£ç†

```python
driver = await uc.start(
    headless=True,
    no_sandbox=True,
    browser_args=[
        '--proxy-server=http://proxy.example.com:8080'
    ]
)
```

## æ€§èƒ½ä¼˜åŒ–

### å‡å°‘ç­‰å¾…æ—¶é—´

```python
# ä¸è¦è¿‡åº¦ç­‰å¾…
await tab.sleep(3)  # å¤Ÿäº†

# ä½¿ç”¨æ›´ç²¾ç¡®çš„é€‰æ‹©å™¨
await tab.select("button[type='submit'].next")  # è€Œä¸æ˜¯ "button"

# å¹¶è¡ŒåŠ è½½
tasks = [
    register_outlook(),
    register_outlook(),
    register_outlook(),
]
await asyncio.gather(*tasks)
```

## å®‰å…¨å»ºè®®

âš ï¸ **é‡è¦å®‰å…¨æç¤ºï¼š**

1. **ä¸è¦ç¡¬ç¼–ç å‡­è¯**
   ```python
   # âŒ é”™è¯¯
   email = "myrealaccount@outlook.com"
   
   # âœ“ æ­£ç¡®
   email = generate_random_email()
   ```

2. **å¦¥å–„ä¿ç®¡ç”Ÿæˆçš„å‡­è¯**
   - ä¸è¦å°† JSON æ–‡ä»¶æäº¤åˆ° Git
   - ä½¿ç”¨ `.gitignore` æ’é™¤è´¦æˆ·æ–‡ä»¶
   ```
   debug_output/
   /tmp/outlook_registration/
   *.json
   ```

3. **éµå®ˆæœåŠ¡æ¡æ¬¾**
   - ä¸ç”¨äºåƒåœ¾é‚®ä»¶
   - ä¸ç”¨äºé’“é±¼
   - ä¸ç”¨äºå¤§è§„æ¨¡éªšæ‰°

4. **ä½¿ç”¨ VPN/ä»£ç†**
   ```python
   # å»ºè®®åœ¨å…¬å…±ç½‘ç»œç¯å¢ƒä¸‹ä½¿ç”¨ä»£ç†
   browser_args=['--proxy-server=...']
   ```

## æ”¯æŒå’Œåé¦ˆ

é‡åˆ°é—®é¢˜ï¼Ÿ

1. **æŸ¥çœ‹è„šæœ¬ç”Ÿæˆçš„æ—¥å¿—**
   - å®Œæ•´ç‰ˆæœ¬: `debug_output/outlook_register_*.log`
   - ç®€åŒ–ç‰ˆæœ¬: æ§åˆ¶å°è¾“å‡º

2. **æŸ¥çœ‹æˆªå›¾**
   - æ¯ä¸ªæ­¥éª¤éƒ½æœ‰æˆªå›¾è®°å½•
   - å¯å¸®åŠ©ç†è§£æ³¨å†Œæµç¨‹

3. **æ£€æŸ¥ HTML è°ƒè¯•ä¿¡æ¯**
   - å®Œæ•´ç‰ˆæœ¬ä¿å­˜é¡µé¢ HTML
   - ç”¨äºç†è§£é¡µé¢ç»“æ„å˜åŒ–

4. **æäº¤é—®é¢˜**
   - åŒ…å«è„šæœ¬ç‰ˆæœ¬
   - åŒ…å«å®Œæ•´çš„é”™è¯¯æ—¥å¿—
   - åŒ…å«æˆªå›¾ï¼ˆå¦‚é€‚ç”¨ï¼‰

## æ›´æ–°å’Œç»´æŠ¤

è¯¥è„šæœ¬å¯èƒ½éœ€è¦å®šæœŸæ›´æ–°ä»¥é€‚åº”ï¼š
- Outlook é¡µé¢ç»“æ„å˜åŒ–
- nodriver åº“æ›´æ–°
- æµè§ˆå™¨ç‰ˆæœ¬å˜åŒ–

**ä¿æŒæ›´æ–°ï¼š**
```bash
git pull origin main
pip install --upgrade nodriver
```

## è®¸å¯è¯

è¯·å‚è€ƒé¡¹ç›®è®¸å¯è¯æ–‡ä»¶ã€‚

## ç¥ä½ å¥½è¿ï¼ ğŸ‰

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Outlook é‚®ç®±è‡ªåŠ¨æ³¨å†Œå®Œæˆï¼             â•‘
â•‘                                         â•‘
â•‘  é‚®ç®±: your_email@outlook.com           â•‘
â•‘  å¯†ç : YourPassword123!                 â•‘
â•‘                                         â•‘
â•‘  âœ“ æ³¨å†ŒæˆåŠŸ                             â•‘
â•‘  âœ“ ä¿¡æ¯å·²ä¿å­˜                           â•‘
â•‘  âœ“ æˆªå›¾å·²è®°å½•                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```
